{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template theme_ufpel/course_header

    Template do header customizado para páginas de curso do tema UFPel.
    Exibe imagem do curso, informações do professor, número de participantes e barra de progresso.
    
    Classes requeridas para JS:
    * course-header - Container principal do header
    * course-progress-bar - Barra de progresso
    * teacher-info - Informações do professor
    * participants-count - Contador de participantes
    
    Context variables required for this template:
    * courseid - ID do curso
    * coursename - Nome do curso
    * courseshortname - Nome curto do curso
    * courseimage - URL da imagem do curso
    * hascourseimage - Boolean indicando se há imagem
    * coursecategory - Categoria do curso
    * coursesummary - Resumo do curso
    * teachers - Array de professores
    * hasteachers - Boolean indicando se há professores
    * participantscount - Número de participantes
    * showparticipants - Boolean para exibir contagem
    * progress - Progresso do curso (0-100)
    * showprogress - Boolean para exibir progresso
    * enrollmentdate - Data de inscrição
    * lastaccess - Último acesso
    * courseurl - URL do curso
    
    Example context (json):
    {
        "courseid": 5,
        "coursename": "Introdução à Programação",
        "courseshortname": "PROG101",
        "courseimage": "https://moodle.ufpel.edu.br/course/image.jpg",
        "hascourseimage": true,
        "coursecategory": "Ciência da Computação",
        "coursesummary": "Curso introdutório de programação...",
        "teachers": [
            {
                "id": 2,
                "fullname": "Prof. João Silva",
                "profileurl": "https://moodle.ufpel.edu.br/user/profile.php?id=2",
                "pictureurl": "https://moodle.ufpel.edu.br/user/pic.jpg"
            }
        ],
        "hasteachers": true,
        "participantscount": 45,
        "showparticipants": true,
        "progress": 75,
        "showprogress": true,
        "enrollmentdate": "01/03/2025",
        "lastaccess": "26/08/2025",
        "courseurl": "https://moodle.ufpel.edu.br/course/view.php?id=5"
    }
}}

<div class="course-header mb-4" data-courseid="{{courseid}}">
    {{! Imagem de capa do curso com overlay }}
    <div class="course-header-image position-relative">
        {{#hascourseimage}}
            <div class="course-cover-image" style="background-image: url('{{{courseimage}}}');">
                <div class="course-overlay"></div>
            </div>
        {{/hascourseimage}}
        {{^hascourseimage}}
            <div class="course-cover-image bg-gradient-ufpel">
                <div class="course-overlay"></div>
            </div>
        {{/hascourseimage}}
        
        {{! Conteúdo sobreposto na imagem }}
        <div class="course-header-content">
            <div class="container">
                <div class="row align-items-end">
                    <div class="col-lg-8">
                        {{! Categoria do curso }}
                        <nav aria-label="{{#str}}coursecategory{{/str}}">
                            <span class="badge badge-light mb-2">
                                <i class="fa fa-folder mr-1"></i> {{coursecategory}}
                            </span>
                        </nav>
                        
                        {{! Nome do curso }}
                        <h1 class="course-title text-white mb-2">
                            {{coursename}}
                        </h1>
                        
                        {{! Nome curto do curso }}
                        <p class="course-shortname text-white-50 mb-3">
                            <i class="fa fa-tag mr-1"></i> {{courseshortname}}
                        </p>
                        
                        {{! Resumo do curso (primeiras 150 caracteres) }}
                        {{#coursesummary}}
                            <p class="course-summary text-white mb-3 d-none d-md-block">
                                {{coursesummary}}
                            </p>
                        {{/coursesummary}}
                    </div>
                    
                    <div class="col-lg-4 text-lg-right">
                        {{! Botões de ação }}
                        <div class="course-actions mb-3">
                            <a href="{{{courseurl}}}/grades" class="btn btn-outline-light btn-sm mr-2">
                                <i class="fa fa-chart-line mr-1"></i> {{#str}}grades{{/str}}
                            </a>
                            <a href="{{{courseurl}}}/participants" class="btn btn-outline-light btn-sm">
                                <i class="fa fa-users mr-1"></i> {{#str}}participants{{/str}}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    {{! Barra de informações abaixo da imagem }}
    <div class="course-info-bar bg-white border-bottom">
        <div class="container py-3">
            <div class="row align-items-center">
                {{! Informações do professor }}
                {{#hasteachers}}
                    <div class="col-md-4">
                        <div class="teacher-info d-flex align-items-center">
                            <span class="text-muted mr-2">
                                <i class="fa fa-chalkboard-teacher"></i> 
                                {{#str}}teacher, theme_ufpel{{/str}}:
                            </span>
                            {{#teachers}}
                                {{#first}}
                                    <a href="{{{profileurl}}}" class="d-flex align-items-center text-decoration-none">
                                        <img src="{{{pictureurl}}}" 
                                             alt="{{fullname}}" 
                                             class="rounded-circle mr-2"
                                             width="30" 
                                             height="30">
                                        <span class="teacher-name text-dark">{{fullname}}</span>
                                    </a>
                                {{/first}}
                            {{/teachers}}
                            {{#multipleTeachers}}
                                <span class="text-muted ml-2">
                                    +{{additionalTeachersCount}} {{#str}}others{{/str}}
                                </span>
                            {{/multipleTeachers}}
                        </div>
                    </div>
                {{/hasteachers}}
                
                {{! Contador de participantes }}
                {{#showparticipants}}
                    <div class="col-md-2">
                        <div class="participants-count">
                            <i class="fa fa-users text-muted mr-1"></i>
                            <span class="text-muted">{{#str}}participants, theme_ufpel{{/str}}:</span>
                            <strong>{{participantscount}}</strong>
                        </div>
                    </div>
                {{/showparticipants}}
                
                {{! Datas importantes }}
                <div class="col-md-3">
                    <div class="course-dates small text-muted">
                        {{#enrollmentdate}}
                            <div>
                                <i class="fa fa-calendar-check mr-1"></i>
                                {{#str}}enrolledon{{/str}}: {{enrollmentdate}}
                            </div>
                        {{/enrollmentdate}}
                        {{#lastaccess}}
                            <div>
                                <i class="fa fa-clock mr-1"></i>
                                {{#str}}lastaccess{{/str}}: {{lastaccess}}
                            </div>
                        {{/lastaccess}}
                    </div>
                </div>
                
                {{! Status de conclusão }}
                <div class="col-md-3">
                    {{#showprogress}}
                        <div class="course-progress">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="small text-muted">
                                    {{#str}}courseprogress, theme_ufpel{{/str}}
                                </span>
                                <span class="small font-weight-bold">{{progress}}%</span>
                            </div>
                            <div class="progress course-progress-bar" style="height: 8px;">
                                <div class="progress-bar bg-ufpel-primary" 
                                     role="progressbar" 
                                     style="width: {{progress}}%"
                                     aria-valuenow="{{progress}}" 
                                     aria-valuemin="0" 
                                     aria-valuemax="100">
                                </div>
                            </div>
                            {{#iscomplete}}
                                <div class="text-success small mt-1">
                                    <i class="fa fa-check-circle mr-1"></i> 
                                    {{#str}}coursecompleted{{/str}}
                                </div>
                            {{/iscomplete}}
                        </div>
                    {{/showprogress}}
                    {{^showprogress}}
                        <div class="text-muted small">
                            <i class="fa fa-info-circle mr-1"></i>
                            {{#str}}progressnotavailable{{/str}}
                        </div>
                    {{/showprogress}}
                </div>
            </div>
        </div>
    </div>
    
    {{! Breadcrumb navegação do curso }}
    <div class="course-breadcrumb bg-light">
        <div class="container py-2">
            <nav aria-label="{{#str}}breadcrumb{{/str}}">
                <ol class="breadcrumb mb-0 bg-transparent">
                    <li class="breadcrumb-item">
                        <a href="{{{homeurl}}}">
                            <i class="fa fa-home"></i>
                        </a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="{{{homeurl}}}/course">{{#str}}courses{{/str}}</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="{{{categoryurl}}}">{{coursecategory}}</a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                        {{courseshortname}}
                    </li>
                </ol>
            </nav>
        </div>
    </div>
</div>

{{! Estilos CSS específicos para o header do curso }}
<style>
.course-header .course-cover-image {
    height: 250px;
    background-size: cover;
    background-position: center;
    position: relative;
}

.course-header .course-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        to bottom,
        rgba(0, 0, 0, 0.3) 0%,
        rgba(0, 0, 0, 0.7) 100%
    );
}

.course-header .course-header-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 2rem 0;
    z-index: 1;
}

.course-header .course-title {
    font-family: "Antonio", sans-serif;
    font-size: 2.5rem;
    font-weight: 700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.course-header .course-summary {
    max-width: 600px;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

.course-header .course-info-bar {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.course-header .teacher-info img {
    border: 2px solid #fff;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

@media (max-width: 768px) {
    .course-header .course-cover-image {
        height: 180px;
    }
    
    .course-header .course-title {
        font-size: 1.75rem;
    }
    
    .course-header .course-info-bar .col-md-4,
    .course-header .course-info-bar .col-md-2,
    .course-header .course-info-bar .col-md-3 {
        margin-bottom: 1rem;
    }
}
</style>
