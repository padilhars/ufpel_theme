define("theme_ufpel/darkmode",["exports","jquery","core/ajax","core/notification"],(function(_exports,_jquery,_ajax,_notification){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_jquery),_ajax=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_ajax),_notification=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_notification);class DarkModeToggle{constructor(){this.storageKey="theme_ufpel_darkmode",this.bodyClass="theme-dark-mode",this.toggleBtn=null,this.isDarkMode=!1,this.loadSavedState()}init(selector=".darkmode-toggle"){this.toggleBtn=document.querySelector(selector),this.toggleBtn||(this.createToggleButton()),this.toggleBtn&&this.toggleBtn.addEventListener("click",(e=>{e.preventDefault(),this.toggle()})),this.applyState(),this.addKeyboardShortcut(),this.syncBetweenTabs()}createToggleButton(){const navbar=document.querySelector(".navbar .navbar-nav");if(navbar){const li=document.createElement("li");li.className="nav-item";const button=document.createElement("button");button.className="nav-link btn darkmode-toggle",button.setAttribute("aria-label","Toggle dark mode"),button.setAttribute("title","Toggle dark mode"),button.innerHTML='<i class="fa fa-moon" aria-hidden="true"></i><span class="sr-only">Toggle dark mode</span>',li.appendChild(button),navbar.appendChild(li),this.toggleBtn=button}}loadSavedState(){const saved=localStorage.getItem(this.storageKey);null!==saved?this.isDarkMode="true"===saved:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(this.isDarkMode=!0)}async saveState(){localStorage.setItem(this.storageKey,this.isDarkMode.toString());try{await _ajax.default.call([{methodname:"core_user_update_user_preferences",args:{preferences:[{name:"theme_ufpel_darkmode",value:this.isDarkMode?"1":"0"}]}}])}catch(error){console.warn("Failed to save dark mode preference:",error)}}applyState(){const body=document.body,icon=this.toggleBtn?.querySelector("i");this.isDarkMode?(body.classList.add(this.bodyClass),icon&&(icon.classList.remove("fa-moon"),icon.classList.add("fa-sun")),this.updateThemeColor("#1a1a1a")):(body.classList.remove(this.bodyClass),icon&&(icon.classList.remove("fa-sun"),icon.classList.add("fa-moon")),this.updateThemeColor("#0080FF")),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{darkMode:this.isDarkMode}}))}toggle(){this.isDarkMode=!this.isDarkMode,document.body.classList.add("theme-transitioning"),this.applyState(),this.saveState(),setTimeout((()=>{document.body.classList.remove("theme-transitioning")}),300),this.showNotification()}showNotification(){const message=this.isDarkMode?"Modo escuro ativado":"Modo claro ativado",notification=document.createElement("div");notification.className="darkmode-notification",notification.textContent=message,notification.style.cssText=`position:fixed;bottom:20px;right:20px;background:${this.isDarkMode?"#333":"#fff"};color:${this.isDarkMode?"#fff":"#333"};padding:12px 20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:9999;animation:slideInUp 0.3s ease;`,document.body.appendChild(notification),setTimeout((()=>{notification.style.animation="slideOutDown 0.3s ease",setTimeout((()=>notification.remove()),300)}),2e3)}updateThemeColor(color){let meta=document.querySelector('meta[name="theme-color"]');meta||(meta=document.createElement("meta"),meta.name="theme-color",document.head.appendChild(meta)),meta.content=color}addKeyboardShortcut(){document.addEventListener("keydown",(e=>{e.altKey&&"d"===e.key&&(e.preventDefault(),this.toggle())}))}syncBetweenTabs(){window.addEventListener("storage",(e=>{e.key===this.storageKey&&(this.isDarkMode="true"===e.newValue,this.applyState())}))}}_exports.init=selector=>{"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{const darkMode=new DarkModeToggle;darkMode.init(selector)})):((new DarkModeToggle).init(selector))},(0,_jquery.default)(document).ready((()=>{("true"===document.body.dataset.darkmodetoggle||(0,_jquery.default)("body").hasClass("darkmode-enabled"))&&(0,_exports.init)()}))}))

//# sourceMappingURL=darkmode.min.js.map